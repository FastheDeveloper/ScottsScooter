# Getting Started

> **Note**: Make sure you have completed the [React Native - Environment Setup](https://reactnative.dev/docs/environment-setup) instructions till "Creating a new application" step, before proceeding.

## Step 1: Start your Application

Let Metro Bundler run in its _own_ terminal. Open a _new_ terminal from the _root_ of your React Native project. Run the following command to start your _Android_ or _iOS_ app:

### For Android

```bash
npx expo run android
```

### For iOS

```bash
npx expo run ios
```

## Step 2: Setup Supabse

> **Note**: Make sure you have completed the [Build a User Management App with Expo React Native](https://supabase.com/docs/guides/getting-started/tutorials/with-expo-react-native) instructions with setting up a supabase account and project with Auth.

### Create 'Scooters' table, using this sql query in the sql editor

```bash
create table if not exists public.scooters (
	id int generated by default as identity primary key,
	location geography(POINT) not null,
  battery float default 0
);

```

### Enable postgis extension in supabase dashboard

#### Create GEO Index

```bash
create index scooters_geo_index
  on public.scooters
  using GIST (location);
```

#### Add location data to match your location

```bash
insert into public.scooters(location)
values
  (st_point(2.1589, 41.3907)),
  (st_point(2.1765, 41.3835)),
  (st_point(2.1897, 41.3942)),
  (st_point(2.1614, 41.3768))...

```

#### Create nearby_function to be called from the mobile app

```bash
create or replace function nearby_scooters(lat float, long float)
returns table (id public.scooters.id%TYPE, battery public.scooters.battery%TYPE, lat float, long float, dist_meters float)
language sql
as $$
  select id, battery, st_y(location::geometry) as lat, st_x(location::geometry) as long, st_distance(location, st_point(long, lat)::geography) as dist_meters
  from public.scooters
  order by location <-> st_point(long, lat)::geography;
$$;
```

#### Copy Supabase url

#### Copy Supabase Anon key

## Step 3: Setup MapBox

#### Create a Mapbox account

#### Copy Mapbox public key

## Step 4: Setup .env file

```bash
EXPO_PUBLIC_MAPBOX_PK=
EXPO_PUBLIC_SUPABASE_URL=
EXPO_PUBLIC_SUPABASE_ANON_KEY=

```
